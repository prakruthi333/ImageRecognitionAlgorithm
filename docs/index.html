<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>index.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Prakruthi Gowda</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Image Recognition Algorithm</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div id="this-project-aims-to-build-an-image-recognition-algorithm-to-increase-the-efficiency-of-the-work-order-reviews-in-water-industries" class="section level1">
<h1><strong>This project aims to build an Image Recognition Algorithm to increase the efficiency of the work order reviews in Water Industries</strong></h1>
<div id="codes" class="section level2">
<h2>Codes</h2>
<p>CNN’s: <a href="https://gist.github.com/prakruthi333/55b29a76cda20d2626a5e277c0fc2f8f" class="uri">https://gist.github.com/prakruthi333/55b29a76cda20d2626a5e277c0fc2f8f</a></p>
<p>MobileNet: <a href="https://gist.github.com/prakruthi333/c5c5056ebb0b8cba6d39f6aedf6e995e" class="uri">https://gist.github.com/prakruthi333/c5c5056ebb0b8cba6d39f6aedf6e995e</a></p>
<p>Vgg16: <a href="https://gist.github.com/prakruthi333/68aec72d0e3da7a9bf322e55c281bbdd" class="uri">https://gist.github.com/prakruthi333/68aec72d0e3da7a9bf322e55c281bbdd</a></p>
<p>Visualising Model: <a href="https://gist.github.com/prakruthi333/e9877c6c57994afdcf14fb2bcabbfd02" class="uri">https://gist.github.com/prakruthi333/e9877c6c57994afdcf14fb2bcabbfd02</a></p>
<p>Water and sewer mains pipes are distributed around Victoria. Every Year water industries receives numerous faulty repairs, majority being replacing burst main(broken pipe). Work order is approved by Water industries which includes reviewing the images. A minimum of 20 photos are attached for each repair, and at least 10,00,000 images are received every year. Approximately 30% of these images are reviewed manually for quality and work completion making it a tedious job. The main objective of the project is to decrease the time spent on approving the work order by use of automation.</p>
<p><img src="images/Bluepipe.png" /></p>
</div>
<div id="objectives" class="section level2">
<h2>Objectives</h2>
<p>-To build an algorithm that is accurate. Our objective was to obtain 95% accuracy when classifying images.</p>
<p>-The algorithm will indicate for each image whether a new water main or new stop tap is present.</p>
<p>-The algorithm is quick. Once the algorithm is trained, it has to sort through at least 500 photos in less than 5 minutes.</p>
<p>-The algorithm has to be quick inorder to save a significant amount of time for the employees.</p>
<p>-The final objective was that the algorithm should be user friendly. No extensive prior knowledge of computer programming is required to use the algorithm.</p>
</div>
<div id="dataset" class="section level2">
<h2>Dataset</h2>
<p>The data for this project was composed of images taken from various work sites by contractors responsible for repairing the faulty sites. The final set of images contained roughly 1,200 photos of burst water main as well as images of various other parts of work sites that came in with these pictures. These “other” images were useful in building our algorithms as they provided the data to classify our images against.</p>
</div>
<div id="data-preprocessing" class="section level2">
<h2>Data Preprocessing</h2>
<p>-The computer reads the image as three matrices of pixel values. One each for the red, green and blue color index. Using the python package keras, the images were imported and reshaped to the same size.</p>
<p>-The pixel values were then normalized between 0 and 1.</p>
<p>-Using keras the dataset was split into training and test/validation data based on a percentage. Here it was 80/20 split for training and validation data.</p>
</div>
<div id="building-algorithms" class="section level2">
<h2>Building Algorithms</h2>
<p>Once preprocessed, Image recognition algorithms were built using Convolutional Neural Networks(CNNs). CNNs are a type of deep learning that contain convolutional layers used to pick up patterns in the data, that otherwise might not be seen.</p>
<p>Using the best deep learning library keras, deep convolutional networks were built. Convolutional neural networks are composed of convolutional layer, a pooled layer and a fully connected layer. The convolutional layer is the important part of Convolutional neural network as it extracts features images or feature maps. Each convolutional layer can consist of multiple convolutional kernels which extracts multiple features. A pooling layer is typically sandwiched between two convolutional layers, which reduces the dimensions of the feature map and maintains the scale invariance. The fully connected layer integrates the result after the image as been passed through multiple convolutional layers and pooling layers to obtain the high-layer semantic feature for image classification.</p>
<p>The first attempt at providing accurate classifiers started with building these CNNs from scratch. Building the CNNs does not necessarily mean that the architecture of the algorithm was created. It simply implies that the algorithm was trained exclusively on data provided. Different combinations of Convolutional and non Convolutional layers were attempted but discovered that the best results was from using the architecture of the littleVGG network. This network consisted of 7 blocks of convolutions, each ending with dropout layer for regularization to help prevent overfitting.</p>
<p><img src="images/Plots.png" /></p>
<p>When training the models several tools were used to prevent overfitting to the training data. After each step (called epoch) the algorithm uses the validation data set to test the algorithm. If the algorithm goes through a set amount of epochs without decreasing the loss function value, the algorithm will end training and revert to the best weights (lowest loss value on validation data). It can be observed from the above figure that the decrease in the loss values and increase in accuracy as the model progresses.</p>
<p>As it can be observed the loss dips quickly at the start and slower as time goes on. Eventually at epoch 38, it hits the lowest loss value on the validation data. These are the weights that settle on for the algorithm, and are restored when the model finishes training. It’s important to keep these checks in place to guarantee our models accuracy will remain similar when used on new images.</p>
</div>
<div id="transfer-learning-algorithms" class="section level2">
<h2>Transfer learning Algorithms</h2>
<p>After attempting to build the model from scratch, next was to build models using transfer learning. Transfer learning involves using a CNN’s trained on another larger image data set, and applying it to your own images.</p>
<p>During the project, building a plethora of models were attempted using transfer learning. Three of the most popular were MobileNet, ResNet and VGG16. For each of these structured models were trained on the imagenet data set. All of the models plateaued over a much shorter amount of epochs.</p>
<p>MobileNet was the most impressive, hitting its highest validation loss score at only the 3rd epoch. These models had a tendency to quickly start overfitting to the training data. The most difficulty with ResNet, as it would quickly begin scoring in the 90+% accuracy on the training data, but maintaining a low accuracy on the validation data. As ResNet As ResNet had the most layers, it made sense that it would overfit with a small amount of images to train on.</p>
</div>
<div id="visualising-models" class="section level2">
<h2>Visualising Models</h2>
<p>Once the models were trained it was important to inspect these classifiers, and attempt to verify their validity. One way this could be achieved was by visualizing what the models were making their decisions on. This was done by creating heat maps that highlighted important pixel clusters. A function was created that found based on the last convolutional layer. The higher this value, the more these pixels had an effect on the final result. In this way, it would take individual images and look at what pixel clusters made them classify the image the way it did. This tool was used to double check. However, if the object that is the subject of the classification is playing the primary role on the classification it strengthens the confidence in the algorithms results.</p>
<p><img src="images/image1.png" /> <img src="images/image.png" /></p>
</div>
<div id="results" class="section level2">
<h2>Results</h2>
<p>After building the models, it was checked on the test data set. This is a set of images that the algorithms had not seen,hence to check th4 performance. Similar to the results from our validation data, the models built using transfer learning performed better than the models LittleVGG. Looking at the VGG16 model, MobileNet model, and LittleVGG model trained only on the data of pipes, it showed that the VGG16 model outperformed the others when comparing overall accuracy.</p>
<p><img src="images/result1.PNG" /></p>
<p>Although VGG16 scored a higher accuracy, it’s important to look past this score and take in all of the information in this project. it was observed that the VGG16 algorithm has the highest f1 score for classifying burst pipes, as well as high precision and recall scores.</p>
<p>The MobileNet does not have a high recall score for classifying these, but as an extremely high precision. For each of the algorithms, the recall score for classifying burst pipes was higher.</p>
<p>The algorithm built without the use of transfer learning scored the lowest accuracy, and recall scores lower than the other two algorithms.</p>
<p>It can also be observed that the accuracies follow a general trend in VGG16 than MobileNet which is better than LittleVGG. It can be noted that in both the MobileNet and VGG16 there is a dip from training and validation to test data. This is less than 3% for the VGG16 model, but MobileNet’s accuracy dips over 7% from validation to test data. As early stopping was used based on the validation data, this is important to note that it may imply overfitting to validation data.</p>
<hr />
<p><a href = "https://crumplab.github.io"></p>
</a>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
